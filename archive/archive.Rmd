---
title: "Untitled"
author: "Cherin-Juliette"
date: '2022-05-28'
output: html_document
---


```{r}
# Create dataset
data <- data.frame(
  id=seq(1,60),
  individual=paste( "Mister ", seq(1,60), sep=""),
  value=sample( seq(10,100), 60, replace=T)
)
 
# Make the plot
p <- ggplot(data, aes(x=as.factor(id), y=value)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
  
  # This add the bars with a blue color
  geom_bar(stat="identity", fill=alpha("blue", 0.3)) +
  
  # Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
  ylim(-100,120) +
  
  # Custom the theme: no axis title and no cartesian grid
  theme_minimal() +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
  ) +
  
  # This makes the coordinate polar instead of cartesian.
  coord_polar(start = 0)
p
```


```{r out.width="900px}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "hu")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2

knitr::include_graphics(
  here::here(
    "images",
    "rcolorUtrecht_hu.png"
  )
)

```

```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "microscope")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2

```



```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "patatjes4life")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "ah")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "vogelenbuurt")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```

```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "geese")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2

rcolorUtrecht::rcolorUtrecht
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "organs")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "ibis_hotel")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "the_wale")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "derk_wessels")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "miffy")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "trains")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```


```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "the_wonders")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```

```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "ships_with_ducdalf")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```

```{r}
library(magrittr)
library(tidyverse)
library(ggplot2)
devtools::load_all()

df <- mpg %>%
  dplyr::group_by(manufacturer) %>%
  dplyr::mutate(manufacturer = str_to_title(manufacturer))%>%
  tally()

df

pl2 <- ggplot(data = df,aes(x= reorder(manufacturer, - n), y = n,fill = manufacturer))
pl2 <- pl2 + geom_bar(stat = "identity")
pl2 <- pl2 + geom_text(aes(label = n), size =  2, vjust = -0.3)
pl2 <- pl2 + theme_classic() + scale_fill_rcolorUtrecht(palette = "uu")
pl2 <- pl2 + theme(legend.position = "none")
pl2 <- pl2 + ggeasy::easy_rotate_labels(which = "x", angle = 90)
pl2 <- pl2 + labs(x = "Car Manufacturers", y= "Number of Models")
pl2 <-pl2 + labs(title = "Models from each manufacturer")
pl2 <- pl2 + labs(subtitle = "Shown in descending order of  number of models")

pl2
```












```{r}
library(ggplot2)
library(RColorBrewer)
ngroup=30
names=paste("G_",seq(1,ngroup),sep="")
DAT=data.frame()

for(i in seq(1:30)){
    data=data.frame( matrix(0, ngroup , 3))
    data[,1]=i
    data[,2]=sample(names, nrow(data))
    data[,3]=prop.table(sample( c(rep(0,100),c(1:ngroup)) ,nrow(data)))
    DAT=rbind(DAT,data)
    }
colnames(DAT)=c("Year","Group","Value")
DAT=DAT[order( DAT$Year, DAT$Group) , ]


coul = brewer.pal(12, "Paired") 
coul = colorRampPalette(coul)(ngroup)
coul=coul[sample(c(1:length(coul)) , size=length(coul) ) ]

ggplot(DAT, aes(x=Year, y=Value, fill=Group )) + 
    geom_area(alpha=1  )+
    theme_bw() +
    #scale_fill_brewer(colour="red", breaks=rev(levels(DAT$Group)))+
    scale_fill_manual(values = coul)+
     theme(
        text = element_blank(),
        line = element_blank(),
        title = element_blank(),
        legend.position="none",
        panel.border = element_blank(),
        panel.background = element_blank())
```

```{r}
set.seed(345) #set the seed of R's random number generator
library(ggplot2)
library(RColorBrewer)
ngroup=20 # changes how many groups there are in the art graph
names=paste("G_",seq(1,ngroup),sep="")
DAT=data.frame()

#creating dataframe 
for(i in seq(1:20)){ #must change if changed the ngroup from previous code block
    data=data.frame( matrix(0, ngroup , 3))
    data[,1]=i
    data[,2]=sample(names, nrow(data))
    data[,3]=prop.table(sample( c(rep(0,100),c(1:ngroup)) ,nrow(data)))
    DAT=rbind(DAT,data)
    }
colnames(DAT)=c("Year","Group","Value")
DAT=DAT[order( DAT$Year, DAT$Group) , ]

coul = rcolorUtrecht_pal(12, "Paired") 
coul = colorRampPalette(coul)(ngroup)
coul=coul[sample(c(1:length(coul)) , size=length(coul) ) ] #deciding the color for the pallete

ggplot(DAT2, aes(x=Year, y=Value, fill=Group )) + 
    geom_area(alpha=1 , color=1 )+
    theme_bw() +
    scale_fill_manual(values = coul)+
     theme(line = element_blank(),
        text = element_blank(),
        title = element_blank(),
        legend.position="none",
        panel.border = element_blank(),
        panel.background = element_blank())
```














```{r}
ggplot(data=diamonds,aes(x=price, group=clarity, fill=clarity, position="stack")) +
 geom_density(adjust=1.5, position="fill") + theme_void() + scale_fill_dutchmasters(palette = "milkmaid")

ggplot(data=diamonds,aes(x=price, group=cut, fill=cut, position="stack")) + 
geom_density(adjust=1.5, position="fill") + scale_fill_rcolorUtrecht(palette = "uu")
```



